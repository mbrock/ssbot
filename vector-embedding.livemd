# vector embedding stuff

## Section

```elixir
index = ExFaiss.Index.new(1536, "Flat")
```

```elixir
tensors =
  NodeTown.Graph.get()
  |> RDF.Data.descriptions()
  |> Enum.filter(& &1[NodeTown.NS.ActivityStreams.content()])
  |> Enum.map(fn x ->
    text =
      x[NodeTown.NS.ActivityStreams.content()]
      |> Enum.map(&RDF.Literal.value/1)
      |> List.first()

    tensor =
      text
      |> GPT3.embedding!()
      |> Nx.tensor()

    {text, tensor}
  end)
```

```elixir
index =
  Enum.reduce(tensors, {0, index}, fn {_text, tensor}, {i, idx} ->
    {i + 1, ExFaiss.Index.add(idx, tensor)}
  end)
```

```elixir
{_, index} = index
```

```elixir
food = GPT3.embedding!("philosophy")
similar = ExFaiss.Index.search(index, food, 15)

similar.labels
|> Nx.to_flat_list()
|> Enum.map(fn i -> Enum.at(tensors, i) end)
|> Enum.map(fn {text, _} -> text end)
|> Enum.each(&IO.puts/1)
```

```elixir

```
